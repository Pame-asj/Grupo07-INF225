{% extends 'base_docente.html' %}

{% block navegacion %}
<li class="nav-item"><a class="nav-link" href="{% url 'docente_index' %}">Inicio</a></li>
<li class="nav-item"><a class="nav-link active" href="{% url 'listar_ensayos' %}">Gestionar Ensayos</a></li>
<li class="nav-item"><a class="nav-link" href="{% url 'resultados_docente' %}">Resultados</a></li>
<li class="nav-item"><a class="nav-link" href="{% url 'listar_preguntas' %}">Banco de Preguntas</a></li>
{% endblock %}

{% block cuenta-atras %}
<li class="nav-item"><a class="nav-link" href="{% url 'cuenta_docente' %}">Cuenta</a></li>
<li class="nav-item"><a href="{% url 'logout' %}" class="nav-link">Cerrar sesi√≥n</a></li>
{% endblock %}

{% block content %}
<h2 class="mb-4">{{ form.instance.pk|yesno:"Editar ensayo,Nuevo ensayo" }}</h2>

<form method="post">
    {% csrf_token %}
    
    <!-- Campos principales -->
    <div class="mb-3">
        {{ form.titulo.label_tag }}
        {{ form.titulo }}
    </div>
    
    <!-- Selector de temas existentes -->
    <div class="mb-3">
        {{ form.temas.label_tag }}
        {{ form.temas }}
        <small class="text-muted">{{ form.temas.help_text }}</small>
    </div>
    
    <!-- Campo para nuevo tema -->
    <div class="mb-3">
        {{ form.nuevo_tema.label_tag }}
        {{ form.nuevo_tema }}
        <small class="text-muted">{{ form.nuevo_tema.help_text }}</small>
    </div>
    
    <!-- Resto de campos -->
    <div class="mb-3">
        {{ form.nivel.label_tag }}
        {{ form.nivel }}
    </div>
    
    <div class="mb-3">
        {{ form.colegio.label_tag }}
        {{ form.colegio }}
    </div>
    
    <div class="mb-3">
        {{ form.preguntas.label_tag }}
        {{ form.preguntas }}
    </div>
    
    <button type="submit" class="btn btn-success">Guardar</button>
    <a href="{% url 'listar_ensayos' %}" class="btn btn-secondary">Cancelar</a>
</form>

<!-- JavaScript para mejorar UX -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const temasSelect = document.getElementById('id_temas');
    const nuevoTemaInput = document.getElementById('id_nuevo_tema');
    
    temasSelect.addEventListener('change', function() {
        if (this.selectedOptions.length > 0) {
            nuevoTemaInput.value = '';
        }
    });
    
    nuevoTemaInput.addEventListener('input', function() {
        if (this.value.length > 0) {
            Array.from(temasSelect.options).forEach(opt => opt.selected = false);
        }
    });
});
</script>
{% endblock %}